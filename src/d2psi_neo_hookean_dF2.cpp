#include <d2psi_neo_hookean_dq2.h>
#include <iostream>
void d2psi_neo_hookean_dF2(Eigen::Matrix99d &ddw, Eigen::Ref<const Eigen::Matrix3d> F, double C, double D) {

    Eigen::Matrix99d T;
    T.setZero();
    //F - first version

    double F1_1,F1_2,F1_3,F2_2,F2_1,F2_3,F3_3,F3_2,F3_1;
    F1_1 = F(0,0);
    F1_2 = F(0,1);
    F1_3 = F(0,2);
    F2_1 = F(1,0);
    F2_2 = F(1,1);
    F2_3 = F(1,2);
    F3_1 = F(2,0);
    F3_2 = F(2,1);
    F3_3 = F(2,2);


    //Log NeoHookean:
    T(0,0) = C*2.0-(C*2.0)/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+D*pow(F2_2*F3_3-F2_3*F3_2,2.0)*2.0+C*(F1_1*F1_1)*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(0,1) = D*(F2_1*F3_3-F2_3*F3_1)*(F2_2*F3_3-F2_3*F3_2)*-2.0+C*F1_1*F1_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(0,2) = D*(F2_1*F3_2-F2_2*F3_1)*(F2_2*F3_3-F2_3*F3_2)*2.0+C*F1_1*F1_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(0,3) = D*(F1_2*F3_3-F1_3*F3_2)*(F2_2*F3_3-F2_3*F3_2)*-2.0+C*F1_1*F2_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(0,4) = D*(F1_1*F3_3-F1_3*F3_1)*(F2_2*F3_3-F2_3*F3_2)*2.0-D*F3_3*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_1*F2_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(0,5) = D*(F1_1*F3_2-F1_2*F3_1)*(F2_2*F3_3-F2_3*F3_2)*-2.0+D*F3_2*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_1*F2_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(0,6) = D*(F1_2*F2_3-F1_3*F2_2)*(F2_2*F3_3-F2_3*F3_2)*2.0+C*F1_1*F3_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(0,7) = D*(F1_1*F2_3-F1_3*F2_1)*(F2_2*F3_3-F2_3*F3_2)*-2.0+D*F2_3*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_1*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(0,8) = D*(F1_1*F2_2-F1_2*F2_1)*(F2_2*F3_3-F2_3*F3_2)*2.0-D*F2_2*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_1*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(1,0) = D*(F2_1*F3_3-F2_3*F3_1)*(F2_2*F3_3-F2_3*F3_2)*-2.0+C*F1_1*F1_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(1,1) = C*2.0-(C*2.0)/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+D*pow(F2_1*F3_3-F2_3*F3_1,2.0)*2.0+C*(F1_2*F1_2)*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(1,2) = D*(F2_1*F3_2-F2_2*F3_1)*(F2_1*F3_3-F2_3*F3_1)*-2.0+C*F1_2*F1_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(1,3) = D*(F1_2*F3_3-F1_3*F3_2)*(F2_1*F3_3-F2_3*F3_1)*2.0+D*F3_3*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_2*F2_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(1,4) = D*(F1_1*F3_3-F1_3*F3_1)*(F2_1*F3_3-F2_3*F3_1)*-2.0+C*F1_2*F2_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(1,5) = D*(F1_1*F3_2-F1_2*F3_1)*(F2_1*F3_3-F2_3*F3_1)*2.0-D*F3_1*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_2*F2_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(1,6) = D*(F1_2*F2_3-F1_3*F2_2)*(F2_1*F3_3-F2_3*F3_1)*-2.0-D*F2_3*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_2*F3_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(1,7) = D*(F1_1*F2_3-F1_3*F2_1)*(F2_1*F3_3-F2_3*F3_1)*2.0+C*F1_2*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(1,8) = D*(F1_1*F2_2-F1_2*F2_1)*(F2_1*F3_3-F2_3*F3_1)*-2.0+D*F2_1*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_2*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(2,0) = D*(F2_1*F3_2-F2_2*F3_1)*(F2_2*F3_3-F2_3*F3_2)*2.0+C*F1_1*F1_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(2,1) = D*(F2_1*F3_2-F2_2*F3_1)*(F2_1*F3_3-F2_3*F3_1)*-2.0+C*F1_2*F1_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(2,2) = C*2.0-(C*2.0)/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+D*pow(F2_1*F3_2-F2_2*F3_1,2.0)*2.0+C*(F1_3*F1_3)*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(2,3) = D*(F1_2*F3_3-F1_3*F3_2)*(F2_1*F3_2-F2_2*F3_1)*-2.0-D*F3_2*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_3*F2_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(2,4) = D*(F1_1*F3_3-F1_3*F3_1)*(F2_1*F3_2-F2_2*F3_1)*2.0+D*F3_1*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_3*F2_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(2,5) = D*(F1_1*F3_2-F1_2*F3_1)*(F2_1*F3_2-F2_2*F3_1)*-2.0+C*F1_3*F2_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(2,6) = D*(F1_2*F2_3-F1_3*F2_2)*(F2_1*F3_2-F2_2*F3_1)*2.0+D*F2_2*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_3*F3_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(2,7) = D*(F1_1*F2_3-F1_3*F2_1)*(F2_1*F3_2-F2_2*F3_1)*-2.0-D*F2_1*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_3*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(2,8) = D*(F1_1*F2_2-F1_2*F2_1)*(F2_1*F3_2-F2_2*F3_1)*2.0+C*F1_3*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(3,0) = D*(F1_2*F3_3-F1_3*F3_2)*(F2_2*F3_3-F2_3*F3_2)*-2.0+C*F1_1*F2_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(3,1) = D*(F1_2*F3_3-F1_3*F3_2)*(F2_1*F3_3-F2_3*F3_1)*2.0+D*F3_3*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_2*F2_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(3,2) = D*(F1_2*F3_3-F1_3*F3_2)*(F2_1*F3_2-F2_2*F3_1)*-2.0-D*F3_2*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_3*F2_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(3,3) = C*2.0-(C*2.0)/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+D*pow(F1_2*F3_3-F1_3*F3_2,2.0)*2.0+C*(F2_1*F2_1)*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(3,4) = D*(F1_1*F3_3-F1_3*F3_1)*(F1_2*F3_3-F1_3*F3_2)*-2.0+C*F2_1*F2_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(3,5) = D*(F1_1*F3_2-F1_2*F3_1)*(F1_2*F3_3-F1_3*F3_2)*2.0+C*F2_1*F2_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(3,6) = D*(F1_2*F2_3-F1_3*F2_2)*(F1_2*F3_3-F1_3*F3_2)*-2.0+C*F2_1*F3_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(3,7) = D*(F1_1*F2_3-F1_3*F2_1)*(F1_2*F3_3-F1_3*F3_2)*2.0-D*F1_3*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F2_1*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(3,8) = D*(F1_1*F2_2-F1_2*F2_1)*(F1_2*F3_3-F1_3*F3_2)*-2.0+D*F1_2*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F2_1*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(4,0) = D*(F1_1*F3_3-F1_3*F3_1)*(F2_2*F3_3-F2_3*F3_2)*2.0-D*F3_3*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_1*F2_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(4,1) = D*(F1_1*F3_3-F1_3*F3_1)*(F2_1*F3_3-F2_3*F3_1)*-2.0+C*F1_2*F2_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(4,2) = D*(F1_1*F3_3-F1_3*F3_1)*(F2_1*F3_2-F2_2*F3_1)*2.0+D*F3_1*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_3*F2_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(4,3) = D*(F1_1*F3_3-F1_3*F3_1)*(F1_2*F3_3-F1_3*F3_2)*-2.0+C*F2_1*F2_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(4,4) = C*2.0-(C*2.0)/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+D*pow(F1_1*F3_3-F1_3*F3_1,2.0)*2.0+C*(F2_2*F2_2)*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(4,5) = D*(F1_1*F3_2-F1_2*F3_1)*(F1_1*F3_3-F1_3*F3_1)*-2.0+C*F2_2*F2_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(4,6) = D*(F1_2*F2_3-F1_3*F2_2)*(F1_1*F3_3-F1_3*F3_1)*2.0+D*F1_3*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F2_2*F3_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(4,7) = D*(F1_1*F2_3-F1_3*F2_1)*(F1_1*F3_3-F1_3*F3_1)*-2.0+C*F2_2*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(4,8) = D*(F1_1*F2_2-F1_2*F2_1)*(F1_1*F3_3-F1_3*F3_1)*2.0-D*F1_1*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F2_2*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(5,0) = D*(F1_1*F3_2-F1_2*F3_1)*(F2_2*F3_3-F2_3*F3_2)*-2.0+D*F3_2*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_1*F2_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(5,1) = D*(F1_1*F3_2-F1_2*F3_1)*(F2_1*F3_3-F2_3*F3_1)*2.0-D*F3_1*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_2*F2_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(5,2) = D*(F1_1*F3_2-F1_2*F3_1)*(F2_1*F3_2-F2_2*F3_1)*-2.0+C*F1_3*F2_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(5,3) = D*(F1_1*F3_2-F1_2*F3_1)*(F1_2*F3_3-F1_3*F3_2)*2.0+C*F2_1*F2_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(5,4) = D*(F1_1*F3_2-F1_2*F3_1)*(F1_1*F3_3-F1_3*F3_1)*-2.0+C*F2_2*F2_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(5,5) = C*2.0-(C*2.0)/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+D*pow(F1_1*F3_2-F1_2*F3_1,2.0)*2.0+C*(F2_3*F2_3)*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(5,6) = D*(F1_2*F2_3-F1_3*F2_2)*(F1_1*F3_2-F1_2*F3_1)*-2.0-D*F1_2*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F2_3*F3_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(5,7) = D*(F1_1*F2_3-F1_3*F2_1)*(F1_1*F3_2-F1_2*F3_1)*2.0+D*F1_1*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F2_3*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(5,8) = D*(F1_1*F2_2-F1_2*F2_1)*(F1_1*F3_2-F1_2*F3_1)*-2.0+C*F2_3*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(6,0) = D*(F1_2*F2_3-F1_3*F2_2)*(F2_2*F3_3-F2_3*F3_2)*2.0+C*F1_1*F3_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(6,1) = D*(F1_2*F2_3-F1_3*F2_2)*(F2_1*F3_3-F2_3*F3_1)*-2.0-D*F2_3*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_2*F3_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(6,2) = D*(F1_2*F2_3-F1_3*F2_2)*(F2_1*F3_2-F2_2*F3_1)*2.0+D*F2_2*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_3*F3_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(6,3) = D*(F1_2*F2_3-F1_3*F2_2)*(F1_2*F3_3-F1_3*F3_2)*-2.0+C*F2_1*F3_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(6,4) = D*(F1_2*F2_3-F1_3*F2_2)*(F1_1*F3_3-F1_3*F3_1)*2.0+D*F1_3*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F2_2*F3_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(6,5) = D*(F1_2*F2_3-F1_3*F2_2)*(F1_1*F3_2-F1_2*F3_1)*-2.0-D*F1_2*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F2_3*F3_1*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(6,6) = C*2.0-(C*2.0)/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+D*pow(F1_2*F2_3-F1_3*F2_2,2.0)*2.0+C*(F3_1*F3_1)*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(6,7) = D*(F1_1*F2_3-F1_3*F2_1)*(F1_2*F2_3-F1_3*F2_2)*-2.0+C*F3_1*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(6,8) = D*(F1_1*F2_2-F1_2*F2_1)*(F1_2*F2_3-F1_3*F2_2)*2.0+C*F3_1*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(7,0) = D*(F1_1*F2_3-F1_3*F2_1)*(F2_2*F3_3-F2_3*F3_2)*-2.0+D*F2_3*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_1*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(7,1) = D*(F1_1*F2_3-F1_3*F2_1)*(F2_1*F3_3-F2_3*F3_1)*2.0+C*F1_2*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(7,2) = D*(F1_1*F2_3-F1_3*F2_1)*(F2_1*F3_2-F2_2*F3_1)*-2.0-D*F2_1*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_3*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(7,3) = D*(F1_1*F2_3-F1_3*F2_1)*(F1_2*F3_3-F1_3*F3_2)*2.0-D*F1_3*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F2_1*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(7,4) = D*(F1_1*F2_3-F1_3*F2_1)*(F1_1*F3_3-F1_3*F3_1)*-2.0+C*F2_2*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(7,5) = D*(F1_1*F2_3-F1_3*F2_1)*(F1_1*F3_2-F1_2*F3_1)*2.0+D*F1_1*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F2_3*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(7,6) = D*(F1_1*F2_3-F1_3*F2_1)*(F1_2*F2_3-F1_3*F2_2)*-2.0+C*F3_1*F3_2*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(7,7) = C*2.0-(C*2.0)/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+D*pow(F1_1*F2_3-F1_3*F2_1,2.0)*2.0+C*(F3_2*F3_2)*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(7,8) = D*(F1_1*F2_2-F1_2*F2_1)*(F1_1*F2_3-F1_3*F2_1)*-2.0+C*F3_2*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(8,0) = D*(F1_1*F2_2-F1_2*F2_1)*(F2_2*F3_3-F2_3*F3_2)*2.0-D*F2_2*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_1*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(8,1) = D*(F1_1*F2_2-F1_2*F2_1)*(F2_1*F3_3-F2_3*F3_1)*-2.0+D*F2_1*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F1_2*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(8,2) = D*(F1_1*F2_2-F1_2*F2_1)*(F2_1*F3_2-F2_2*F3_1)*2.0+C*F1_3*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(8,3) = D*(F1_1*F2_2-F1_2*F2_1)*(F1_2*F3_3-F1_3*F3_2)*-2.0+D*F1_2*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F2_1*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(8,4) = D*(F1_1*F2_2-F1_2*F2_1)*(F1_1*F3_3-F1_3*F3_1)*2.0-D*F1_1*((C*(3.0/4.0))/D-F1_1*F2_2*F3_3+F1_1*F2_3*F3_2+F1_2*F2_1*F3_3-F1_2*F2_3*F3_1-F1_3*F2_1*F3_2+F1_3*F2_2*F3_1+1.0)*2.0+C*F2_2*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(8,5) = D*(F1_1*F2_2-F1_2*F2_1)*(F1_1*F3_2-F1_2*F3_1)*-2.0+C*F2_3*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(8,6) = D*(F1_1*F2_2-F1_2*F2_1)*(F1_2*F2_3-F1_3*F2_2)*2.0+C*F3_1*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(8,7) = D*(F1_1*F2_2-F1_2*F2_1)*(F1_1*F2_3-F1_3*F2_1)*-2.0+C*F3_2*F3_3*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    T(8,8) = C*2.0-(C*2.0)/(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0)+D*pow(F1_1*F2_2-F1_2*F2_1,2.0)*2.0+C*(F3_3*F3_3)*1.0/pow(F1_1*F1_1+F1_2*F1_2+F1_3*F1_3+F2_1*F2_1+F2_2*F2_2+F2_3*F2_3+F3_1*F3_1+F3_2*F3_2+F3_3*F3_3+1.0,2.0)*4.0;
    ddw=T;

}